# Scheduling

## Manually Scheduling

**Why is the POD in the pending state?**

先 Describe 看看有沒有 Node 有無被值。

接著查看 Scheduler 有沒有在 running 。

```bash
$ kubectl get pods -n kube-system
```



**Manually schedule the pod on node01.
Delete and recreate the POD if necessary.**

已經在新增的 pod ，不允許修改 nodeName 後再 `kubectl apply -f nginx.yaml`。所以要刪掉重建。

或是直接用 replace 的方式:

```bash
$ kubectl replace --force -f nginx.yaml
```


## Labels and Selectors

**計算某個 labels 的 Pod 數量**

可以使用 --no-headers 和 wc -l 來計算。

- 使用 `kubectl get pods --no-headers` 來過濾掉標頭。
- `wc` 是 "word count" 的縮寫，是一個用於計數的工具。`-l`q 選項特指計算行數。

```bash
$ kubectl get pods --no-headers | wc -l
```


**How many objects are in the prod environment including PODs, ReplicaSets and any other objects?**

```sh
kubectl get all -l env=prod --no-headers | wc -l
```


**修正 replicaset-definition-1.yaml 問題**

```bash
$ cat replicaset-definition-1.yaml 
apiVersion: apps/v1
kind: ReplicaSet
metadata:
   name: replicaset-1
spec:
   replicas: 2
   selector:
      matchLabels:
        tier: front-end
   template:
     metadata:
       labels:
         tier: nginx
     spec:
       containers:
       - name: nginx
         image: nginx
```

因為 `spec.selector.matchLabels` 和 `template.metadata.labels` 的 tier 不同，執行時會報錯。

```sh
$ kubectl replace --force -f replicaset-definition-1.yaml 
The ReplicaSet "replicaset-1" is invalid: spec.template.metadata.labels: Invalid value: map[string]string{"tier":"nginx"}: `selector` does not match template `labels`
```

**如何一次把同一個 labels 的資源列出來？**


